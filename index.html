<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Student Business Club - Order Now</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .fade-section { opacity: 0; transition: opacity 0.8s ease-in-out; }
    .fade-section.visible { opacity: 1; }
    .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); justify-content: center; align-items: center; z-index: 1000; }
    .modal-content { background: #1f2937; padding: 2rem; border-radius: 1rem; max-width: 550px; width: 90 В%; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 50px rgba(0,0,0,0.7); }
    .loading { pointer-events: none; opacity: 0.6; }
    .loading::after { content: ""; position: absolute; width: 20px; height: 20px; border: 3px solid #fff; border-top-color: transparent; border-radius: 50%; animation: spin 1s linear infinite; left: 50%; top: 50%; transform: translate(-50%,-50%); }
    @keyframes spin { to { transform: translate(-50%,-50%) rotate(360deg); } }
  </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">

  <!-- [Same beautiful HTML as before – only the <script> part changed] -->
  <!-- I'll keep the full design but only show the updated script below for clarity -->

  <!-- Order Form Section (same as before) -->
  <section id="order" class="min-h-screen flex flex-col items-center justify-center p-6 fade-section pt-32">
    <h2 class="text-5xl font-bold mb-12 text-blue-400">Place Your Order</h2>
    <form id="orderForm" class="w-full max-w-3xl bg-gray-800 p-10 rounded-3xl shadow-2xl border border-gray-700 space-y-8">
      <!-- All your inputs exactly the same -->
      <div class="grid md:grid-cols-3 gap-6">
        <input type="text" name="name" placeholder="Your Full Name" class="p-4 rounded-xl bg-gray-700 text-lg" required />
        <input type="email" name="email" placeholder="Email Address" class="p-4 rounded-xl bg-gray-700 text-lg" required />
        <input type="tel" name="tel" placeholder="Phone Number (e.g. 078...)" class="p-4 rounded-xl bg-gray-700 text-lg" required />
      </div>
      <!-- Product checkboxes and options – unchanged -->
      <!-- ... (same as previous version) ... -->
      <button type="button" id="confirmOrderBtn" class="w-full py-5 bg-gradient-to-r from-blue-600 to-cyan-600 text-2xl font-bold rounded-xl hover:from-blue-700 hover:to-cyan-700 transform hover:scale-105 transition duration-300 shadow-xl">
        Review My Order
      </button>
    </form>

    <!-- Modal – unchanged -->
    <div id="orderModal" class="modal">
      <div class="modal-content text-gray-200">
        <h3 class="text-3xl font-bold mb-6 text-blue-400 text-center">Confirm Your Order</h3>
        <div id="orderSummary" class="space-y-4 text-lg"></div>
        <div class="mt-8 pt-6 border-t-2 border-gray-600">
          <div class="text-3xl font-bold text-right text-green-400" id="totalPrice">Total: 0 RWF</div>
        </div>
        <div class="flex justify-between mt-10">
          <button id="cancelOrder" class="px-8 py-4 bg-gray-600 rounded-xl text-xl hover:bg-gray-700 transition">Cancel</button>
          <button id="submitOrder" class="relative px-10 py-4 bg-green-600 rounded-xl text-xl font-bold hover:bg-green-700 transform hover:scale-110 transition shadow-xl">
            Confirm & Send Order
          </button>
        </div>
      </div>
    </div>
  </section>

  <script>
    // === ALL YOUR EXISTING JS (fade, toggles, etc.) remains the same ===
    // Only the submission part is updated below

    const MAKE_WEBHOOK = "https://hook.us2.make.com/ygz8rqdikqtsgsrpe43pqy5249vnvnyj";

    document.getElementById('submitOrder').addEventListener('click', async () => {
      const btn = document.getElementById('submitOrder');
      btn.classList.add('loading');
      btn.innerHTML = '<span>Sending...</span>';

      const name = document.querySelector('[name="name"]').value.trim();
      const email = document.querySelector('[name="email"]').value.trim();
      const phone = document.querySelector('[name="tel"]').value.trim();

      // Individual quantities (0 if not selected)
      const soap_3L = document.querySelector('input[name="soapSize"]:checked')?.value === '3L' 
        ? parseInt(document.getElementById('soapCount3L').value) || 0 : 0;
      const soap_5L = document.querySelector('input[name="soapSize"]:checked')?.value === '5L' 
        ? parseInt(document.getElementById('soapCount5L').value) || 0 : 0;
      const bread_10pack = document.querySelector('input[name="breadSize"]:checked')?.value === '10pack' 
        ? parseInt(document.getElementById('breadCount10').value) || 0 : 0;
      const bread_6pack = document.querySelector('input[name="breadSize"]:checked')?.value === '6pack' 
        ? parseInt(document.getElementById('breadCount6').value) || 0 : 0;

      const total = (soap_3L * 2500) + (soap_5L * 4000) + (bread_10pack * 1500) + (bread_6pack * 2000);
      const submitted_at = new Date().toLocaleString('en-GB', { timeZone: 'Africa/Kigali' });

      // THIS IS THE PAYLOAD Make.com will receive – perfect for your email template
      const payload = {
        name,
        email,
        phone,
        soap_3L,        // e.g. 2 or 0
        soap_5L,        // e.g. 0 or 3
        bread_10pack,   // e.g. 5 or 0
        bread_6pack,    // e.g. 0 or 1
        total: total + " RWF",
        submitted_at
      };

      try {
        const res = await fetch(MAKE_WEBHOOK, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        if (res.ok) {
          alert("Order sent successfully! We will contact you very soon.");
          document.getElementById('orderModal').style.display = 'none';
          document.getElementById('orderForm').reset();
          document.querySelectorAll('#soapOptions, #breadOptions').forEach(el => el.classList.add('hidden'));
        } else {
          alert("Failed to send. Please check your connection and try again.");
        }
      } catch (err) {
        alert("No internet connection. Please try again when you're online.");
      } finally {
        btn.classList.remove('loading');
        btn.innerHTML = 'Confirm & Send Order';
      }
    });

    // Keep all your existing confirmOrderBtn logic for the modal summary (unchanged)
    // ... (same as previous version)
  </script>
</body>
</html>
